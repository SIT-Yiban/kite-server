## 概念

集五福活动是虎年想出来的一个新项目，类似支付宝的集五福活动。用户将使用 “上应小风筝” 在身边扫描校徽图案，并传至服务器识别。服务器识别出校徽后，发放给 用户相应的福卡。这其中，用户单日可获得的福卡有上限，且单次扫描得到福卡的概率不为
1。活动将在特定时刻截止，截止后，由工作人员分配奖品并录入系统，系统再通知用户。

卡片有以下几种：

| 编号 | 名称   |
| ---- | ------ |
| 0    | 无卡片 |
| 1    | 上应福 |
| 2    | 创新福 |
| 3    | 博学福 |
| 4    | 富贵福 |
| 5    | 康宁福 |
| 6    | 风筝福 |

卡片对应的图片和其他资源，可以在 [kite-fu](https://github.com/kite-fu) 中找到。

## 接口

### POST /badge/image

上传校徽图片。该接口由 [kite-badge](https://github.com/SIT-kite/kite-badge) 项目提供，路径与其他接口有所不同，详见对应的项目。

若 `Content-Type` 为 `image/jpeg`，则直接存储并处理图片。否则，若为 `text/plain`，则将请求体作为 base64 后的原图片处理。其他的值将会导致服务端返回 `400 Bad Request`。

#### 响应示例

```json
{
  "code": 0,
  "data": {
    "result": 3,
    "card": 2
  }
}
```

抽卡结果可能为：

1. 没有识别到校徽
2. 当日集卡已达次数限制
3. 抽中了
4. 活动结束

如果 `result` 为 `3`，即用户抽中卡片， `card` 字段表示用户抽中卡片的类型，该类型预定义于客户端和服务端， 此时服务器会自动记录该用户的中奖情况。若用户未抽中卡片， `card` 的值将为  `0`。

### GET /badge/card/

获取自己的福卡列表，该接口无需提供任何参数。

#### 响应示例

```json
{
  "code": 0,
  "data": [
    {
      "card": 1,
      "ts": "2022-1-28T09:00:12Z"
    }
  ]
}
```

### GET /badge/result

获取活动参与结果的地址。 当活动结果出炉时，服务器返回中奖公告链接。若无记录，则 `result` 置为 `0`，且 `url` 为 `null`。

#### 响应示例

```json
{
  "code": 0,
  "data": {
    "result": 1,
    "url": "https://mp.wx.qq.com/..."
  }
}
```

