## 概念

消费查询包括**校园卡消费**与**宿舍电费**查询。

操作的资源主要有：

- /pay/room/{*room*} 查询电费余额

- /pay/consumption/{*studentId*} 查询消费记录

  

## 接口

### [GET] /pay/room/{*roomId*}

查询房间电费余额（仅支持奉贤校区）。

房间 ID 的计算规则是由电费查询系统规定的。格式为 “10” + 楼号 + 寝室号，如果遇到仅为个位的楼号，不补零。例如，对于1号楼101寝室，对应的房间 ID 为 `101101`。

余额更新可能有延迟，详见校内 OA [相关页面](card.sit.edu.cn)。

#### 权限

普通用户。

#### 参数

| 参数   | 类型   | 必填 | 释义   | 合法值 |
| ------ | ------ | ---- | ------ | ------ |
| roomId | string | 是   | 房间号 |        |

#### 响应示例

```json
{
    "code": 0,
    "msg": "OK",
    "data": {
        "event_id": 12
    }
}
```

### [GET] /pay/room/{*roomId*}/bill/days

按日进行用电统计

#### 权限

普通用户。

#### 参数

| 参数   | 类型   | 必填 | 释义   | 合法值 |
| ------ | ------ | ---- | ------ | ------ |
| roomId | string | 是   | 房间号 |        |
| start  | string | 否   | 统计开始日期 |   |
| end    | string | 否   | 统计结束日期 |   |

1. `start`、`end` 的格式为 `yyyy-mm-dd`
2. 若某日数据在数据库中不存在，或该日未消费，接口会将该日消费量记为 0 以便前端使用
3. 若省略 `start`， 则默认为上周该日（7天前）的日期，若省略`end`，则默认为今日
4. 数值均为正数

#### 响应示例

```json
{
  "code": 0,
  "data": [
    {
      "date": "2020-12-14",
      "charge": 0.0,
      "consumption": 2.5620003
    },
    {
      "date": "2020-12-15",
      "charge": 0.0,
      "consumption": 1.4029999
    }
  ]
}
```


## 错误代码

| 代码 | 说明                                   |
| ---- | -------------------------------------- |
| 200  | 无对应房间数据 | `NoSuchRoom`    |
