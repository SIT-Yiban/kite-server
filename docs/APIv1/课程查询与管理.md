## 课程查询与管理

课程查询与管理模块提供课程信息查询、成绩查询、教学计划查询等服务。访问所有接口均需要登录，一些接口需要`密码` 方式实名。

操作的资源主要有：

- /edu/course 课程列表
- /edu/course/{courseCode} 查看开课班级
- /edu/major 查看专业列表
- /edu/major/{majorCode}  查看教学计划
- /edu/student/{student_id} 查看教务系统认证信息
- /edu/student/{student_id}/schedule/term/{term} 查看课程表
- /edu/student/{student_id}/score/term/{term} 查询成绩
- /edu/classroom/available 查询空闲教室



## 接口

### [GET] /edu/course

查询课程列表。请注意必填的接口参数。

#### 权限

已登录用户。

#### 参数

| 参数  | 类型   | 必填   | 释义                         | 合法值                           |
| ----- | ------ | ------ | ---------------------------- | -------------------------------- |
| q     | string | **是** | 模糊查询课程名称             | 不为空                           |
| term  | string | 否     | 学期，不指定则默认为当前学期 | 如 `2020A` 表示 19 - 20 第二学期 |
| index | int    | 否     | 分页页号                     | 从 1 开始                        |
| count | int    | 否     | 单页条目数                   | 1 ~ 20                           |

#### 响应示例

``` json5
{
    "code":0,
    "data":[
        {
            "term":"2020B",
            "code":"B1040111",
            "title":"程序设计基础（VB.Net）",
            "type":"公共基础课",
            "credit":3.0,
            "class_count":2
        }, /* ... */
    ]
}
```



### [GET] /edu/course/{courseCode}

查询某一课程下的开课班级信息。

#### 权限

已登录用户。

#### 参数

| 参数       | 类型   | 必填 | 释义                         | 合法值                           |
| ---------- | ------ | ---- | ---------------------------- | -------------------------------- |
| courseCode | string | 是   | 课程代码                     | 须精确匹配                       |
| term       | string | 否   | 学期，不指定则默认为当前学期 | 如 `2020A` 表示 19 - 20 第二学期 |

#### 响应示例

```json5
{
  "code": 0,
  "data": {
    "course": {
      "term": "2020B",
      "code": "B310424",
      "title": "中级财务会计1",
      "css_id": "2003255",
      "type": "专业必修课",
      "credit": 3.0,
      "class_count": 3
    },
    "classes": [
      {
        "teacher": ["朱娜娜"],
        "place": ["二教E310"],
        "campus":"奉贤校区",
        "plan_count": 44,
        "selected_count": 36,
        "arranged_class": ["19110161"],
        "schedule": [
          {
            "day_index":3,
            "day_range":[5,6],
            "type":2,
            "week_range":[1,16]
          }, /* ... */
        ]
      }, /* ... */
    ]
  }
}
```



### [GET] /edu/major

查询学校专业列表。

#### 权限

已登录用户。

#### 参数

（**TODO**：考虑添加分页）

| 参数 | 类型   | 必填 | 释义           | 合法值 |
| ---- | ------ | ---- | -------------- | ------ |
| q    | string | 是   | 专业名称关键词 |        |

#### 响应示例

``` json5
{
  "code": 0,
  "data": [
    {
      "category":"B0402",
      "code":"B040201",
      "title":"软件工程",
      "last_update":"2020-07-28T07:38:13.594770"
    },
    /* ... */
}
```



### [GET] /edu/major/{majorCode}

查询指定专业的教学计划。

#### 权限

已登录用户。

#### 参数

| 参数      | 类型   | 必填   | 释义     | 合法值                          |
| --------- | ------ | ------ | -------- | ------------------------------- |
| majorCode | string | 是     | 专业代码 |                                 |
| year      | int    | **否** | 入学年份 | 2017 至当前年份，默认为上一年份 |

#### 响应示例

``` json5
{
    "code": 0,
    "data": [
        {
            "course_category":"公共基础课",
            "code":"B1221031",
            "title":"高等数学（工）1",
            "has_test":true,
            "credit":6.0,
            "term":1
        },
        {
            "course_category":"公共基础课",
            "code":"B1230002",
            "title":"大学生体育测试（二）",
            "has_test":false,
            "credit":0.5,
            "term":7
        },  /* ... */
    ]
}
```



### [GET] /edu/classroom/available

查询空闲教室情况

#### 权限

已登录用户。

#### 参数

| 参数     | 类型   | 必填 | 释义               | 合法值                       |
| -------- | ------ | ---- | ------------------ | ---------------------------- |
| campus   | 整数   | 否   | 校区               | 1或2,1是奉贤校区,2是徐汇校区 |
| building | string | 否   | 楼号               | 须精确匹配 如：一教，二教    |
| region   | string | 否   | 教学楼编号         | 须精确匹配 须在A-I之间       |
| date     | string | 是   | 查询空教室的日期   | 正常日期 如：2021-9-6        |
| time     | string | 否   | 使用空闲教室的时间 | 数字须在1和11之间            |
| index    | 整数   | 否   | 页码               | 不小于 1                     |
| count    | 整数   | 否   | 每页最大条目数     | 默认5，不超过20              |

#### 响应示例

``` json5
{
    "code": 0,
    "data": [
        {
            "room": "A103",
            "busy_time": 126,
            "capacity": 187
        },
        {
            "room": "A105",
            "busy_time": 30,
            "capacity": 242
        },
        {
            "room": "A108",
            "busy_time": 30,
            "capacity": 88
        },
        {
            "room": "A110",
            "busy_time": 126,
            "capacity": 88
        },
        {
            "room": "A112",
            "busy_time": 30,
            "capacity": 88
        },
        /* ... */
    ]
}
```
#### 返回值

| 返回值     | 类型        | 释义                                              |
| ---------- | ----------- | ------------------------------------------------|
| room       | string      | 房间号                                           |
| busy_time  | i32         | 使用时应将数字转为二进制,位上为1代表繁忙,0表示空闲      |
| capacity   | i32 or null | 教室内座位的数量                                   |

### [GET] /edu/timetable

查询课表。

#### 权限

已登录用户, 实名用户。

#### 参数

| 参数      | 类型         | 必填 | 释义   | 合法值                                            |
| -------- | ----------- | ---- | ----- | ------------------------------------------------ |
| year     | Option<i32> | 是   | 学年   | 正常学年                                          |
| semester | i32         | 是   | 学期   | 数字, 1代表第一学期, 2代表第二学期, 其他数字代表整个学年 |

#### 响应示例

```json5
{
  "code": 0,
  "data": {
    "timeTable": [
      {
        "course_name": "Web应用系统开发",
        "day": 1,
        "time_index": 6,
        "week": 8190,
        "place": "二教G302",
        "teacher": [
          "朱栩"
        ],
        "campus": "奉贤校区",
        "credit": 2.5,
        "hours": 32.0,
        "dyn_class_id": "0737",
        "course_id": "B3042288",
        "prefered_class": []
      },
      /* ... */
    ]
  }
}
```

####  返回值

| 返回值          | 类型         | 释义                              |
| ----------     | ----------- | --------------------------------- |
| course_name    | String      | 课程名称                           |
| day            | i32         | 星期                              |
| time_index     | i32         | 节次, 以整数形式返回, 解析应转成二进制 |
| week           | i32         | 周次, 以整数形式返回, 解析应转成二进制 |
| place          | String      | 教室                              |
| teacher        | Vec<String> | 教师                              |
| campus         | String      | 校区                              |
| credit         | f32         | 学分                              |
| hours          | f32         | 学时                              |
| dyn_class_id   | String      | 教学班                            |
| course_id      | String      | 课程代码                          |
| prefered_class | Vec<String> | 陪课班, 如果无则返回[]              |


### [GET] /edu/score

查询成绩。

#### 权限

已登录用户, 实名用户。

#### 参数

| 参数      | 类型         | 必填 | 释义   | 合法值                                            |
| -------- | ----------- | ---- | ----- | ------------------------------------------------ |
| year     | Option<i32> | 否   | 学年   | 正常学年                                          |
| semester | i32         | 是   | 学期   | 数字, 1代表第一学期, 2代表第二学期, 其他数字代表整个学年 |

#### 响应示例

```json5
{
  "code": 0,
  "data": {
    "Score": [
      {
        "score": 79.0,
        "course": "形势与政策（2）",
        "course_id": "B1280002",
        "class_id": "2018-12-B1280002",
        "school_year": "2018-2019",
        "semester": "SecondTerm",
        "credit": 0.5
      },
      {
        "score": 73.0,
        "course": "数据结构",
        "course_id": "B2042305",
        "class_id": "2018-12-B2042305",
        "school_year": "2018-2019",
        "semester": "SecondTerm",
        "credit": 3.5
      },
      /* ... */
    ]
  }
}
```

####  返回值

| 返回值         | 类型         | 释义      |
| ------------- | ----------- | --------- |
| score         | f32         | 成绩      |
| course        | String      | 课程      |
| course_id     | String      | 课程代码   |
| class_id      | String      | 班级      |
| school_year   | String      | 学年      |
| semester      | Semester    | 学期      |
| credit        | credit      | 学分      |


### [GET] /edu/score/term/{term}

查询课程成绩。（未实现）

#### 权限

实名用户。

#### 参数

| 参数      | 类型   | 必填 | 释义       | 合法值                           |
| --------- | ------ | ---- | ---------- | -------------------------------- |
| studentId | string | 是   | 专业代码   | 学号                             |
| term      | string | 否   | 查询的学期 | 如 `2020A` 表示 19 - 20 第二学期 |


