## 课程查询与管理

课程查询与管理模块提供课程信息查询、成绩查询、教学计划查询等服务。访问所有接口均需要登录，一些接口需要`密码`方式实名。

操作的资源主要有：

接口 | 说明
---- | ----
`/edu/timetable`           | 查看课程表
`/edu/score`               | 查询成绩
`/edu/score/detail`        | 查询成绩详情
`/edu/classroom/available` | 查询空闲教室
`/edu/calendar`            | 查询校历（开学日期）
`/edu/schedule`            | 查询不同校区和教学楼的上下课时间



### [GET] /edu/timetable

查询课程表。

#### 权限

已登录用户

#### 参数

| 参数     | 类型    | 必填  | 释义  | 合法值                                      |
| -------- | ----   | ---- | ---- | ------------------------------------------  |
| year     | String | 是   | 学年  | 正常学年 如:2020-2021                        |
| semester | i32    | 是   | 学期  | 1：第一学期<br>2：第二学期<br>其他数字：整个学年 |

#### 响应示例

```jsonc
{
  "code": 0,
  "data": {
    "timeTable": [
      {
        "courseName": "Web应用系统开发",
        "day": 1,
        "timeIndex": 6,
        "week": 8190,
        "place": "二教G302",
        "teacher": [ "朱栩" ],
        "campus": "奉贤校区",
        "credit": 2.5,
        "hours": 32.0,
        "dynClassId": "0737",
        "courseId": "B3042288",
        "preferedClass": []
      }, // ...
    ]
  }
}
```

####  返回值

| 返回值        | 类型        | 释义                                   |
| ------------- | ----------- | -------------------------------------- |
| courseName    | String      | 课程名称                               |
| day           | i32         | 星期                                   |
| timeIndex     | i32         | 节次, 以整数形式返回, 解析应转成二进制 |
| week          | i32         | 周次, 以整数形式返回, 解析应转成二进制 |
| place         | String      | 教室                                   |
| teacher       | Vec<String> | 教师                                   |
| campus        | String      | 校区                                   |
| credit        | f32         | 学分                                   |
| hours         | f32         | 学时                                   |
| dynClassId    | String      | 教学班                                 |
| courseId      | String      | 课程代码                               |
| preferedClass | Vec<String> | 陪课班, 如果无则返回空数组 []          |



### [GET] /edu/score

查询成绩。

#### 权限

已实名用户

#### 参数

| 参数      | 类型    | 必填 | 释义 | 合法值   |
| -------- | ------ | ---- | ---- | -------- |
| year     | String | 是   | 学年 | 正常学年 |
| semester | i32    | 是   | 学期 | 1：第一学期<br>2：第二学期<br>其他数字：整个学年 |

#### 响应示例

```jsonc
{
  "code": 0,
  "data": {
    "score": [
      {
        "score": 94.0,
        "course": "计算机网络原理",
        "courseId": "B204212",
        "classId": "2020-3-B204212",
        "schoolYear": "2020-2021",
        "semester": 1,
        "credit": 3.0,
        "detail": null
      },
      {
        "score": 75.0,
        "course": "软件项目管理与案例分析",
        "courseId": "B4045045",
        "classId": "2020-3-B4045045",
        "schoolYear": "2020-2021",
        "semester": 1,
        "credit": 2.5,
        "detail": null
      }, // ...
    ]
  }
}
```

####  返回值

| 返回值     | 类型    | 释义     |
| ---------- | ------- | -------- |
| score      | f32     | 成绩     |
| course     | String  | 课程     |
| courseId   | String  | 课程代码 |
| classId    | String  | 班级     |
| schoolYear | String  | 学年     |
| semester   | u8      | 学期     |
| credit     | f32     | 学分     |
| detail     | Value   | 详情     |



### [GET] /edu/score/detail

查询成绩详情

#### 权限

已实名用户

#### 参数

| 参数      | 类型   | 必填  | 释义    | 合法值                                      |
| -------- | ------ | ---- | ------ | ------------------------------------------ |
| year     | String | 是   | 学年    | 正常学年                                    |
| semester | i32    | 是   | 学期    | 1：第一学期<br>2：第二学期<br>其他数字：整个学年 |
| class_id | String | 是   | 班级编号 | 正常班级编号                                 |

#### 响应示例

```jsonc
{
  "code": 0,
  "data": {
    "score_detail": [
      {
        "scoreType": "平时",
        "percentage": "50%",
        "score": 93.0
      },
      {
        "scoreType": "期末",
        "percentage": "50%",
        "score": 84.0
      },
      {
        "scoreType": "总评",
        "percentage": "0%",
        "score": 89.0
      }
    ]
  }
}
```

####  返回值

| 返回值      | 类型    | 释义    |
| ---------- | ------ | ------- |
| scoreType  | String | 成绩类型 |
| percentage | String | 百分比  |
| score      | f32    | 成绩    |




### [GET] /edu/classroom/available

查询空闲教室情况

#### 权限

已实名用户

#### 参数

| 参数     | 类型   | 必填 | 释义               | 合法值                    |
| -------- | ------ | ---- | ------------------ | ------------------------- |
| campus   | 整数   | 否   | 校区               | 1：奉贤校区，2：徐汇校区  |
| building | string | 否   | 楼号               | 须精确匹配 如：一教，二教 |
| region   | string | 否   | 教学楼编号         | 须精确匹配 须在A-I之间    |
| date     | string | 是   | 查询空教室的日期   | 正常日期 如：2021-9-6     |
| time     | string | 否   | 使用空闲教室的时间 | 数字须在1和11之间         |
| index    | 整数   | 否   | 页码               | 不小于 1                  |
| count    | 整数   | 否   | 每页最大条目数     | 默认5，不超过20           |

#### 响应示例

``` jsonc
{
    "code": 0,
    "data": [
        {
            "room": "A103",
            "busyTime": 126,
            "capacity": 187
        },
        {
            "room": "A105",
            "busyTime": 30,
            "capacity": 242
        },
        {
            "room": "A108",
            "busyTime": 30,
            "capacity": 88
        },
        {
            "room": "A110",
            "busyTime": 126,
            "capacity": 88
        },
        {
            "room": "A112",
            "busyTime": 30,
            "capacity": 88
        }, // ...
    ]
}
```
#### 返回值

| 返回值   | 类型        | 释义             |
| -------- | ----------- | ---------------- |
| room     | string      | 房间号           |
| busyTime | i32         | 使用时应将数字转为二进制，<br>0表示空闲，1表示繁忙  |
| capacity | i32 or null | 教室内座位的数量 |



### [GET] /edu/calendar

查询校历（开学日期）

#### 权限

无

#### 响应示例

``` json
{
  "code": 0,
  "data": {
    "year": "2021-2022",
    "semester": 1,
    "start": "2021-09-06"
  }
}
```

#### 返回值

| 参数     | 类型   | 释义     |
| -------- | ------ | -------- |
| year     | string | 学年名称 |
| semester | i32    | 1：第一学期<br>2：第二学期 |
| start    | string | 开学日期 |




### [GET] /edu/schedule

查询上下课时间表（疫情期间），[来源](https://mp.weixin.qq.com/s/sSEnTjyhAn1bU8AWy6-zww)。

#### 权限

无

#### 响应示例

``` json
{
  "code": 0,
  "data": {
     "奉贤校区": {
        "default": [
           ["8:20","9:05"],
           ["9:10","9:55"],
           ["10:15","11:00"],
           ["11:05","11:50"],
           ["13:00","13:45"],
           ["13:50","14:35"],
           ["14:55","15:40"],
           ["15:45","16:30"],
           ["18:00","18:45"],
           ["18:50","19:35"],
           ["19:40","20:25"]
        ],
        "一教": [
           ["8:20","9:05"],
           ["9:10","9:55"],
           ["10:25","11:00"],
           ["11:05","12:00"],
           ["13:00","13:45"],
           ["13:50","14:35"],
           ["14:55","15:40"],
           ["15:45","16:30"],
           ["18:00","18:45"],
           ["18:50","19:35"],
           ["19:40","20:25"]
       ]
    }
}
```

#### 返回值

1. 每个校区都有 11 节课，所以每个教学楼及 `default` 对应的列表一定有 11 项
2. 工程实训课时间以具体通知为准

## 错误代码（310~359）

| 代码 | 描述                               | 内部解释           |
| ---- | ---------------------------------- | ------------------ |
| 310  | 签名校验失败                       | `SignFailure`     |

